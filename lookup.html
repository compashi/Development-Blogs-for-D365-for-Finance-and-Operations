<!DOCTYPE HTML>
<html>
	<head>
		<title>Lookup in D365FO</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link rel="shortcut icon" href="images/icon/icon.jpg" />
		<link rel="stylesheet" href="assets/css/main.css" />
	</head>
	<body class="subpage">

		<!-- Header -->
			<header id="header">
				<div class="logo"><a href="index.html">Lookup <span>in D365</span></a></div>
				<a href="#menu">Topics</a>
			</header>

		<!-- Nav -->
			<nav id="menu">
				<ul class="links">
					<li><a href="index.html">Home</a></li>
					<li><a href="loopingDataSource.html">Looping DataSource</a></li>
					<li><a href="lookup.html">Lookup</a></li>
				</ul>
			</nav>

		<!-- One -->
			<section id="One" class="wrapper style3">
				<div class="inner">
					<header class="align-center">
						<p style="text-align: center">D365</p>
						<h2>Lookup</h2>
					</header>
				</div>	
			</section>

		<!-- Main -->
			<div id="main" class="container">

				<!-- Elements -->
					<h2 id="elements"><b>Lookups in Microsoft Dynamics 365 for Finance and Operations</b></h2>
					<div class="row 200%">
                        <div>
                            <p>
                                A lookup control in D365 refers to a drop down that lists certain values. These values can either be static or dynamic (from tables based on certain conditions or just their unique field values). Static lookup's values refer to a base enum element, where as, dynamic lookup's values are set by referring a single or many tables based on certain condition.
                            </p>
                            
                            <p>
                                Static lookup on forms are created by right clicking the design node and selecting <b>Combo Box</b> control. Dynamic lookups on the other hand, can be formed by creating a <b>foreign key relation</b> on the table (if you don't want to specify any condition and want to lookup values of any primary key/unique field that the underlying table has), or by writing custom X++ code in a <a href="https://msdn.microsoft.com/en-us/library/formstringcontrol.aspx" class="recent-posts"><b>FormStringControl</b></a> control's <b>lookup</b> method. This blog displays all of the ways that can be used to create a lookup. 
                            </p>
							
							<p>
								For now, consider that you have implemented a form and attached a data source till now, and now want to implement the requirements that were stated by the dean of the university. 
							</p>
									
							<span class="image fit"><div class="4u"><img src="images/looping_fds/FormDesign.png" alt="Form Design" /></div></span>
							
							<p>
                                To begin with, you would add 2 buttons in the action pane. One for calculating average GPA  that is being displayed on the forms, and the other for sending email to specific students. 
                            </p>
							
							<span class="image fit"><div class="4u"><img src="images/looping_fds/ButtonGroup.png" alt="Button Group" /></div></span>
							
							<p>
                                When you click the Average GPA button, the result from the execution of button is displayed as: 
                            </p>
							
							<span class="image fit"><div class="4u"><img src="images/looping_fds/AveragaGPA.png" alt="Loop Complete FormDataSource" /></div></span>
							
							<p>
                                The code for implementing Average GPA functionality is as (Note that the implementation loops through all records in a FormDataSource):
                            </p>
							
                            <pre>
<code><keyword>public void</keyword> clicked()
{
    <keyword>int</keyword> totalRecords;
    <keyword>RealBase</keyword> averageGPA;
    <keyword>FinalResult</keyword> finalResultRecord;

    <keyword>super</keyword>();

    <comment>// Fetches first record from the FormDataSource</comment>
    <comment>// FinalResult is the name of the table that stores result information</comment>
    finalResultRecord = FinalResult_ds.getFirst() as <keyword>FinalResult</keyword>;

    <comment>// Keeps checking if record fetched from FormDataSource is null</comment>
    <keyword>while</keyword> (finalResultRecord)
    {
        totalRecords++;
        averageGPA += finalResultRecord.GPA;

        <comment>// Get the next record pointed by FormDataSource</comment>
        finalResultRecord = FinalResult_ds.getNext();
    }

    averageGPA = averageGPA / totalRecords;

    info(strFmt(<string>"Average GPA is %1"</string>, averageGPA));
}
</code></pre>
							
							<p>
                                When you click the Email Student button, the result from the execution of button is displayed as (unfortunately the dean called students with less than 2.00 GPA): 
                            </p>
							
							<span class="image fit"><div class="4u"><img src="images/looping_fds/EmailSent.png" alt="Loop Marked Records on FormDataSource" /></div></span>
							
							<p>
                                The code for implementing Average GPA functionality as (Note that the implementation loops through marked records in a FormDataSource):
                            </p>
							
							<pre>
<code><keyword>public void</keyword> clicked()
{
    <keyword>FinalResult</keyword> markedRecord;

    <keyword>super</keyword>();

    <comment>// Fetches first marked record on FormDataSource</comment>
    <comment>// If there are no marked records on the datasource, then it fetches the selected one</comment>
    <keyword>for</keyword> (markedRecord = FinalResult_ds.getFirst(<keyword>true</keyword>)? FinalResult_ds.getFirst(<keyword>true</keyword>) : FinalResult_ds.cursor();
         markedRecord;
         markedRecord = FinalResult_ds.getNext())
    {
        <comment>// Email sending business logic to be coded</comment>

        info(strFmt(<string>"Sucessfully sent email to %1"</string>, markedRecord.StudentName));
    }
}
</code></pre>


							<p>
								Congratulatons for reaching till the end. I hope this blog was helpful and cleared some of you doubts in what situations can this technique be used.
                            </p>
							
							
							<p>
								Feedbacks are always welcomed, or if you want to have a chat about development scenarios in D365FO, feel free to contact me via the social-media icons down below. Cheers.
                            </p>
						</div>
					</div>
			</div>

		<!-- Footer -->
			<footer id="footer">
				<div class="container">
					<ul class="icons">
						<li><a href="https://www.linkedin.com/in/danz1ka19/" class="icon fa-linkedin"><span class="label">Linked in</span></a></li>
						<li><a href="https://www.facebook.com/danz1ka" class="icon fa-facebook"><span class="label">Facebook</span></a></li>
						<li><a href="https://www.instagram.com/danz1ka/" class="icon fa-instagram"><span class="label">Instagram</span></a></li>
						<li><a href="#" class="icon fa-envelope-o"><span class="label">Email</span></a></li>
					</ul>
				</div>
				<div class="copyright">
					&copy; Danyal Imran 2017. All rights reserved.
				</div>
			</footer>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/skel.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>